version: "3"
services:
  mirai:
    build: ./mirai
    container_name: mirai
    restart: always
    ports: 
      - 8081:8080
    volumes: 
      - ./mirai/config.txt:/app/config.txt
      - ./mirai/setting.yml:/app/plugins/MiraiAPIHTTP/setting.yml
      - ./data/mirai_data:/app/data
      - ./data/mirai_image:/app/plugins/MiraiAPIHTTP/images
  bot:
    build: ./bot/deploy
    container_name: mirai_bot
    restart: always
    depends_on: 
      - mirai
    environment: 
      - API_HOST=mirai
      - API_PORT=8080
      - IMAGE_PATH=/app/images
      - DATA_STORAGE_PATH=/app/data
      - API_AUTH_KEY=1234567890
    volumes: 
      - ./data/mirai_image:/app/images
      - ./data/bot_data:/app/data